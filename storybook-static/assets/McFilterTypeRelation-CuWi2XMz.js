import{p as q,r as p,e as u,w as x,q as y,F as g,G as V,x as O,P as B,Q as j,M as b,v as D,L as K,u as F,K as P,H,n as L}from"./vue.esm-bundler-DcuF_pQ3.js";import{_ as U}from"./McButton-Cw3_qabT.js";import{_ as G}from"./McTitle-BRys2FLH.js";import{_ as Q}from"./McFieldSelect-BIwQ6nnt.js";import{_ as W}from"./McFieldText-CElXFiE9.js";import{a as n}from"./filterMocks-B4PAsX4k.js";import{c as z}from"./useTooltip-C3VtZaBe.js";import{u as J}from"./index-DRQZTcpU.js";const X={class:"mc-filter-type-relation__header"},Y={class:"mc-filter-type-relation__buttons"},Z=q({__name:"McFilterTypeRelation",props:{modelValue:{type:[Object],default:()=>({})},filter:{type:Object,default:()=>({})},placeholders:{type:Object,required:!0},currentValues:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(d,{emit:E}){const m=z(),k=E,t=d,A=J(e=>{e()},100),C=p(Object.values(n)),r=p(n.Is),s=p([]),f=p(!1),N=u(()=>t.filter.is_text?W:Q),R=u(()=>t.filter.placeholder||t.filter.is_text?t.placeholders.enter:t.placeholders.choose),c=u(()=>typeof t.filter.getAjaxOptions=="function"),_=u(()=>{let e=c.value?s.value:t.filter.options||[];if(!m.isEmpty(t.currentValues)&&t.filter.value in t.currentValues){const l=t.currentValues[t.filter.value];let a=[];for(let[o,i]of Object.entries(l)){if(o===n.Exists)return[];a=[...a,...Array.isArray(i)?i:[[i]]]}e=e.filter(o=>!a.includes(String(o.value)))}return e}),v=u({get(){let e=t.modelValue;if(e){for(let[l,a]of Object.entries(t.modelValue))l===n.Exists?e=null:e=a[0];c.value&&e&&I(e)}return e},set(e){r.value!==n.Exists&&h(e)}}),S=e=>{r.value!==e&&(r.value=e,h(v.value))},T=async e=>{f.value=!0,s.value=t.filter.getAjaxOptions&&await t.filter.getAjaxOptions(e),f.value=!1},I=async e=>{const l=t.filter.getAjaxOne&&await t.filter.getAjaxOne(e);s.value=m.uniqWith([...s.value,l],m.isEqual)},w=e=>{!c.value||!e||A(()=>T(e))},h=e=>{var i;let l=null,a=null;const o=e||Number.isInteger(e);if(r.value!==n.Exists&&o){const M=t.filter.is_text?e:(i=_.value.find($=>String($.value)===String(e)))==null?void 0:i.name;l={[r.value]:[String(e)]},a={[r.value]:{[String(e)]:M}}}r.value===n.Exists&&!t.currentValues[t.filter.value]&&(l={[n.Exists]:[0]},a={[n.Exists]:[0]}),k("update:modelValue",{value:l,valueName:a})};return x(()=>t.modelValue,e=>{if(e)for(let l of Object.keys(e))r.value=l},{immediate:!0}),x(()=>t.filter,()=>{r.value=n.Is,L(()=>s.value=[])}),(e,l)=>(y(),g(H(N.value),{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=a=>v.value=a),options:_.value,"internal-search":!c.value,placeholder:R.value,loading:f.value,disabled:r.value===F(n).Exists,"hide-selected":"",class:"mc-filter-type-relation",name:`relation_${t.filter.type}`,onSearchChange:w},{header:V(()=>[O("div",X,[B(G,null,{default:V(()=>[j(b(d.placeholders.condition),1)]),_:1}),O("div",Y,[(y(!0),D(P,null,K(C.value,a=>(y(),g(U,{key:a,variation:r.value===a?"purple":"dark-gray-outline",onClick:()=>S(a)},{default:V(()=>[j(b(d.placeholders.actions[`${a===F(n).Exists?"empty":a}`]),1)]),_:2},1032,["variation","onClick"]))),128))])])]),_:1},40,["modelValue","options","internal-search","placeholder","loading","disabled","name"]))}});Z.__docgenInfo={exportName:"default",displayName:"McFilterTypeRelation",description:"",tags:{},props:[{name:"modelValue",description:"Значение",type:{name:"FilterRelationValue"},defaultValue:{func:!0,value:"() => ({})"}},{name:"filter",description:`Объект выбранного
 фильтра`,type:{name:"IRelationFilter"},defaultValue:{func:!0,value:"() => ({})"}},{name:"placeholders",description:"Переводы локализаций",type:{name:"IFilterPlaceholders"},required:!0},{name:"currentValues",description:`Текущее значение
 добавленных фильтров`,type:{name:"FilterConditionValue"},defaultValue:{func:!0,value:"() => ({})"}}],events:[{name:"update:modelValue",type:{names:["IFilterCondition"]}}],sourceFiles:["/Users/user/Documents/work/mediacube-ui-v2/src/components/patterns/McFilter/McFilterTypeRelation/McFilterTypeRelation.vue"]};export{Z as _};
